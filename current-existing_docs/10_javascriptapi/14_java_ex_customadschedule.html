<!DOCTYPE html>
<html>
<head>
    <title></title>

<script src="//content.jwplatform.com/libraries/XeGdlzmk.js"></script>

<meta name="deskURL" content="https://jwplayer.desk.com/admin/content-management/articles/1480844-example-custom-ad-scheduling/edit?select_filter=564475">
</head>

<body>
​​​
<div class="article_callout">This document applies to users of <strong>JW Player Enterprise</strong>. Don&#39;t have Enterprise? <a href="http://www.jwplayer.com/pricing/">Upgrade Now</a>.</div>

<p>Here is an example of a setup of JW Player with VAST advertising client. Instead of using an ad schedule, the&nbsp;<a href="http://support.jwplayer.com/customer/portal/articles/1413089-javascript-api-reference#advertising">Advertising API</a>&nbsp;is used to play an advertisement ad-hoc:</p>

<div class="jwplayer playlist-none" id="container">&nbsp;</div>
<button id="playbutton" onclick="playMyAd()">(start the video first)</button><script type="text/javascript">
var playerInstance = jwplayer("container");
playerInstance.setup({
  file: "//content.jwplatform.com/videos/s8BPzDe0-640.mp4",
  image: "//content.jwplatform.com/thumbs/s8BPzDe0-640.jpg",
  advertising: {
    client: "vast"
  }
});

var btn = document.getElementById("playbutton");
var ply = false;
var tag = "//www.adotube.com/php/services/player/OMLService.php?avpid=oRYYzvQ&platform_version=vast20&ad_type=linear&groupbypass=1&HTTP_REFERER=http://www.longtailvideo.com&video_identifier=longtailvideo.com,test"

playerInstance.on('play',function() {
  ply = true;
  btn.innerHTML = "Play an ad right now!";
  btn.style.background = "#048";
});
playerInstance.on('pause',function() {
  ply = false;
  btn.innerHTML = "(start the video first)";
  btn.style.background = "#666";
});
playerInstance.on('idle',function() {
  ply = false;
  btn.innerHTML = "(start the video first)";
  btn.style.background = "#666";
});
function playMyAd() {
  if(ply) {
    playerInstance.playAd(tag);
    ply = false;
    btn.innerHTML = "(wait until the ad is done)";
  btn.style.background = "#666";
  }
};
</script>

<p>Note that Advertising support is only available in the <strong>Ads</strong> editions of JW Player. See our <a href="http://www.jwplayer.com/pricing/" target="_blank">pricing page</a> for more info.</p>

<h2>Embed code</h2>

<p>As always, ensure you have uploaded a copy of JW Player and included the script in the &lt;head&gt; of your page, together with your player key. See the <a href="http://support.jwplayer.com/customer/portal/articles/1406723-basic-video-embed">Quick Start Guide</a> for more info. Next, place the following embed code at the location you want the player to appear:</p>

<pre>
&lt;div id=&quot;myElement&quot;&gt;&lt;/div&gt;
&lt;script&gt;
var playerInstance = jwplayer(&quot;myElement&quot;);
  playerInstance.setup({
    image: &quot;/uploads/myPoster.jpg&quot;,
    file: &quot;/uploads/myVideo.mp4&quot;,
    advertising: {
      client: &quot;vast&quot;
    }
  });
&lt;/script&gt;
</pre>

<p>Note this setup has no tag or schedule defined, but the advertising block is still setup so the functionality is made available.</p>

<h2>Script code</h2>

<p>With the player set up, it&#39;s time to add the code for playing the ad. First, add a button to trigger it:</p>

<pre>
&lt;button id=&quot;playbutton&quot; onclick=&quot;playMyAd()&quot;&gt;play an ad now!&lt;/button&gt;
</pre>

<p>Next, insert the scripting code that uses the JW Player&nbsp;<a href="http://support.jwplayer.com/customer/portal/articles/1413089-javascript-api-reference#advertising">Advertising API</a>&nbsp;to play the advertisement:</p>

<pre>
&lt;script&gt;
var btn = document.getElementById(&quot;playbutton&quot;);
var tag = &quot;//adserver.com/vastResponse.xml&quot;

// Only play an ad if the video is actually playing.
function playMyAd() {
  if(playerInstance.getState() == &quot;PLAYING&quot;) {
    playerInstance.playAd(tag);
  }
};
&lt;/script&gt;
</pre>

<p>In addition to playing an ad (midroll) while the video is playing, JW Player supports:</p>

<ul>
  <li>Playing an ad inside the&nbsp;<strong>on(&#39;beforePlay&#39;)</strong> handler (for prerolls).</li>
  <li>Playing an ad inside the&nbsp;<strong>on(&#39;beforeComplete&#39;)</strong> handler (for postrolls).</li>
</ul>

<p>Note these Advertising API calls are only available for VAST advertising, not for the Google IMA integration. The API calls are available in both HTML5 and Flash mode.</p>

</body>
</html>